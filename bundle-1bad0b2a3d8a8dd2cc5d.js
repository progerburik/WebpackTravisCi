!function(t){var n={};function e(o){if(n[o])return n[o].exports;var a=n[o]={i:o,l:!1,exports:{}};return t[o].call(a.exports,a,a.exports,e),a.l=!0,a.exports}e.m=t,e.c=n,e.d=function(t,n,o){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:o})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(e.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var a in t)e.d(o,a,function(n){return t[n]}.bind(null,a));return o},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="",e(e.s=0)}([function(t,n,e){"use strict";e.r(n);e(1)},function(t,n){const e="https://progerburik-postr-zagr-backend.herokuapp.com";let o=0,a=0,s=[];const r=document.getElementById("root"),i=document.createElement("form");i.className="form-inline",i.innerHTML='\n<input type="text" class="form-control mb-2 mr-sm-2" data-id="url">\n<select class="form-control mb-2 mr-sm-2" data-id="name">\n    <option value="img">Картинка</option>\n    <option value="video">Видео</option>\n    <option value="audio">Аудио</option>\n    <option value="regular">Обычный</option>\n</select>\n<button class="btn btn-info mb-2" data-action="add">Добавить посты</button>\n',r.appendChild(i);const l=i.querySelector("[data-id=url]"),c=i.querySelector("[data-id=name]");l.value=localStorage.getItem("added"),l.addEventListener("input",t=>{localStorage.setItem("added",t.currentTarget.value)}),null!==localStorage.getItem("name")&&(c.value=localStorage.getItem("name")),c.addEventListener("input",t=>{localStorage.setItem("name",t.currentTarget.value)}),i.addEventListener("submit",t=>{t.preventDefault();const n={name:c.value,content:l.value,id:0};fetch(`${e}/posts`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}).then(t=>{if(!t.ok)throw new Error(t.statusText);return t.json()}).then(t=>{l.value="",c.value="img",localStorage.clear(),s.unshift(t),a=t.id,u(d,s)}).catch(t=>{console.log(t)})});const d=document.createElement("ul");function u(t,n){t.innerHTML="";for(const o of n){const n=document.createElement("li");n.className="list-group-item","img"===o.name?n.innerHTML=`\n                <img src="${o.url}" class="card">\n                ${o.name}\n                <span class="badge badge-warning">likes: ${o.likes}</span>\n                <button type="button" class="btn btn-success btn-sm" data-action="like">like</button>\n                <button type="button" class="btn btn-danger btn-sm" data-action="dislike">dislike</button>\n                <button type="button" class="btn btn-secondary btn-sm" data-action="remove">remove</button>\n                <span class="badge badge-info">id: ${o.id}</span>    \n            `:"audio"===o.name?n.innerHTML=`\n                <audio src="${o.url}" controls="controls" class="card"></audio>\n                ${o.name}\n                <span class="badge badge-warning">likes: ${o.likes}</span>\n                <button type="button" class="btn btn-success btn-sm" data-action="like">like</button>\n                <button type="button" class="btn btn-danger btn-sm" data-action="dislike">dislike</button>\n                <button type="button" class="btn btn-secondary btn-sm" data-action="remove">remove</button>\n                <span class="badge badge-info">id: ${o.id}</span>    \n            `:"video"===o.name?n.innerHTML=`\n                <video src="${o.url}" controls="controls" class="card"></video>\n                ${o.name}\n                <span class="badge badge-warning">likes: ${o.likes}</span>\n                <button type="button" class="btn btn-success btn-sm" data-action="like">like</button>\n                <button type="button" class="btn btn-danger btn-sm" data-action="dislike">dislike</button>\n                <button type="button" class="btn btn-secondary btn-sm" data-action="remove">remove</button>\n                <span class="badge badge-info">id: ${o.id}</span>    \n            `:"regular"===o.name&&(n.innerHTML=`\n                ${o.name}\n                <span class="badge badge-warning">likes: ${o.likes}</span>\n                <button type="button" class="btn btn-success btn-sm" data-action="like">like</button>\n                <button type="button" class="btn btn-danger btn-sm" data-action="dislike">dislike</button>\n                <button type="button" class="btn btn-secondary btn-sm" data-action="remove">remove</button>\n                <span class="badge badge-info">id: ${o.id}</span>    \n            `),n.querySelector("[data-action=like]").addEventListener("click",()=>{fetch(`${e}/posts/${o.id}/likes`,{method:"POST"}).then(t=>{if(!t.ok)throw new Error(t.statusText);return t.json()}).then(t=>{const n=s.findIndex(t=>t.id===o.id);s[n].likes++,u(d,s)}).catch(t=>{console.log(t)})}),n.querySelector("[data-action=dislike]").addEventListener("click",()=>{fetch(`${e}/posts/${o.id}/likes`,{method:"DELETE"}).then(t=>{if(!t.ok)throw new Error(t.statusText);return t.json()}).then(t=>{const n=s.findIndex(t=>t.id===o.id);s[n].likes--,u(d,s)}).catch(t=>{console.log(t)})}),n.querySelector("[data-action=remove]").addEventListener("click",()=>{fetch(`${e}/posts/${o.id}`,{method:"DELETE"}).then(t=>{if(!t.ok)throw new Error(t.statusText);return t.json()}).then(t=>{const n=s.findIndex(t=>t.id===o.id);s.splice(n,1),u(d,s)}).catch(t=>{console.log(t)})}),t.appendChild(n)}}d.className="list-group",r.appendChild(d),fetch(`${e}/posts/seenPosts/${o}`).then(t=>{if(!t.ok)throw new Error(t.statusText);return t.json()}).then((function(t){0!==t.length&&(t.length<5?s.push(...t.reverse()):(o=t[t.length-5].id,s.push(...t.reverse()),b.style.display="block"),u(d,s),console.log(s.length))})).catch(t=>{console.log(t)});const b=document.createElement("button");b.className="btn btn-info mb-2",b.textContent="Загрузить еще",r.appendChild(b),b.addEventListener("click",(function(){fetch(`${e}/posts/seenPosts/${o}`).then(t=>{if(!t.ok)throw new Error(t.statusText);return t.json()}).then((function(t){0===t.length?b.style.display="none":(t.length<5?(o=t[t.length-1].id,s.push(...t.reverse()),b.style.display="none"):(o=t[t.length-5].id,s.push(...t.reverse()),b.style.display="block"),u(d,s))})).catch(t=>{console.log(t)})}))}]);